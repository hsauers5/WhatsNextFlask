<html>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="next" href="categories.html">
<head>

<link rel="shortcut icon" type="image/png" href="img/favicon.png"/>

<style type="text/css">
	html { 
	  background: url(https://raw.githubusercontent.com/hsauers5/KnighthacksFrontend/master/app/assets/moneyBackgound.png) no-repeat center center fixed;
	  -webkit-background-size: cover;
	  -moz-background-size: cover;
	  -o-background-size: cover;
	  background-size: cover;
	}
	body {
		background-repeat: no-repeat;
	}
	.container {
    height: 100%;
		font-family: Arial;
		background-repeat: no-repeat;
    }
	.start-button {
		background-color: #42b0f4;
    color: #FFFFFF;
		border-color: #42b0f4;
		font-family: Arial;
		font-size: 18px;
    padding: 10px;
    border-radius: 0px;
    -moz-border-radius: 0px;
    -webkit-border-radius: 0px;
    margin: 0px
	}
	.intro {
		position: absolute;
		top: 45%;
		left: 50%;
		transform: translate(-50%, -50%);
	}
</style>

<script>

  var lat = 0;
  var lon = 0;

  var options = {
    enableHighAccuracy: true,
    timeout: 5000,
    maximumAge: 0
  };

  function getLocation() {
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(showPosition, null, options);
    } else { 
      x.innerHTML = "Geolocation is not supported by this browser.";
    }
  }

  function showPosition(position) {
    lat = position.coords.latitude;
    lon = position.coords.longitude;
    // alert("Latitude: " + lat + " Longitude: " + lon);
    redirect();
  }
  
  function redirect() {
    showLoading();
    const Http = new XMLHttpRequest();
    const url="categories?location=" + lat + "," + lon;
    Http.open("GET", url);
    Http.send();
    Http.onreadystatechange=(e)=>{
      setTimeout(function(){
        console.log(Http.responseText); window.location.href="categories.html";}, 500);
    }
  }

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js')
  .then(function(response) {
    
    // Service worker registration done
    console.log('Registration Successful', response);
  }, function(error) {
    // Service worker registration failed
    console.log('Registration Failed', error);
  })
}
var lE=document.createElement("link");
lE.rel="manifest",lE.href="app.json",document.head.insertBefore(lE, document.head.firstChild);

</script>

</head>

<body  onload="install()">

	<div id="main" class="container" style="">
		<div class="intro" style="width: 340px">
			<h1 style="color: #5e9ca0; text-align: center; font-style: oblique;"><span style="color: #ffffff;">take the guesswork out of going out.</span></h1>
      <h3 style="color: #5e9ca0; text-align: center; font-style: oblique;"><span style="color: #ffffff;">we help food lovers like you find the best open restaurants in your area</span></h3>
			<p style="text-align: center;">
				<button class="start-button" onclick='getLocation();'> Get Started </button>
			</p>
		</div>
	</div>


  <!-- Page Load -->
<script>

function show(id, value) {
    document.getElementById(id).style.display = value ? 'block' : 'none';
}

function showLoading() {
    // alert(loading);
    // show('page', true);
    show('loading', true);
};


/*

*/

</script>
<style>
#loading {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 100;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    background-image: url("https://cdn.dribbble.com/users/636337/screenshots/4505682/cube-change-loading.gif");
    background-repeat: no-repeat;
    background-position: center;
}
</style>
<div id="loading"></div>



<!-- Mobile Modals -->

<style>
#android-modal {
    display: none;
    position: absolute;
    bottom: 0;
    left: 0;
    z-index: 100;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    background-image: url(https://raw.githubusercontent.com/hsauers5/KnighthacksFrontend/master/app/assets/moneyBackgound.png)
}
#ios-modal {
    display: none;
    position: absolute;
    top: 0;
    left: 0;
    z-index: 100;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    background-image: url(https://raw.githubusercontent.com/hsauers5/KnighthacksFrontend/master/app/assets/moneyBackgound.png)
}
.modal-dialog {
    position: fixed;
		bottom: 0;
		background-color: #282828;
		min-height: 97%; 
		min-width: 100%;
		opacity: 0.95;
		padding-bottom: 50px;
	}
	.modal-content {
		position: absolute;
		top: 45%;
		left: 50%;
    width: 100%;
		transform: translate(-50%, -50%);
	}
	.button-back {
		background-color: #42b0f4;
    color: #FFFFFF;
		border-color: #42b0f4;
		font-family: Arial;
		font-size: 18px;
    padding: 10px;
    border-radius: 0px;
    -moz-border-radius: 0px;
    -webkit-border-radius: 0px;
    margin: 0px;
		min-height: 50px;		
		min-width: 100px;
	}
</style>

<script>
  function install() {

    thisCookie = document.cookie;

    if (! thisCookie.includes("noInstall") && ! thisCookie.includes("noInstall1")) {
      // if iphone, redirect to instructions
      if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
        show('ios-modal', true);
      }

      // if android, redirect to instructions
      if (navigator.userAgent.match(/Android/i)) {
        show('android-modal', true);
      }
    }

  }

  function noThanks() {
    // showLoading();
    // alert(document.cookie);
    
    // read cookie
    cookiearray = document.cookie.split(';');
    numNoInstalls = 1;

    var cookieDict = {};

    for(var i=0; i<cookiearray.length; i++) {
      key = cookiearray[i].split('=')[0];
      value = cookiearray[i].split('=')[1];
      cookieDict[key] = value;
    }

    if (cookieDict['noInstall'] == null) {
      cookieDict['noInstall'] = numNoInstalls;
    }
	  
    if (document.cookie.includes("noInstall")) {
	document.cookie = "noInstall1=" + (parseInt(cookieDict['noInstall'])+1) + ";";
    }

    // set cookie to asked once - should opt out twice.
    document.cookie = "noInstall=" + (parseInt(cookieDict['noInstall'])+1) + ";";
    
    /* Max Date: 2038-01-19 00:00:00 */
    document.cookie = "expires=" + "Fri, 1 Jan 2038 00:00:00 GMT" + ";";
    show("android-modal", false);
    show("ios-modal", false);
    
  }
</script>

<div id="android-modal">
<div class="modal-fade" id="install-modal" tabindex="-1" role="dialog" aria-labelledby="install-modalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		
		<center>
		<h1 class="modal-title" id="install-modalLabel" style="color: #ffffff; font-size: 36; font-family: Arial;">Install WhatsNext</h1>
		</center>
      </div>
	  <center>
      <div class="modal-body">
        <img src="https://raw.githubusercontent.com/hsauers5/WhatsNextFlask/master/images/icons/icon-144x144.png" />
<p>
<!-- <img src="https://raw.githubusercontent.com/hsauers5/WhatsNextFlask/master/add.png" height=130px, width=600px /> -->

  <h3 class="modal-instructions" style="color: #ffffff; font-size: 18; font-family: Arial;font-style: oblique;"> 
    Tap "Options" in your browser,<p> then tap "Add to home screen"
  </h3>

      </div>
      <div class="modal-footer">
	  <button class="button-back" onclick="noThanks()"> No Thanks </button>
      </div>
	  </center>
    </div>
  </div>
</div>
</div>

<div id="ios-modal">
  <div class="modal-fade" id="install-modal" tabindex="-1" role="dialog" aria-labelledby="install-modalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		
		<center>
		<h1 class="modal-title" id="install-modalLabel" style="color: #ffffff; font-size: 36; font-family: Arial;">Install WhatsNext</h1>
		</center>
      </div>
	  <center>
      <div class="modal-body">
        <img src="https://raw.githubusercontent.com/hsauers5/WhatsNextFlask/master/images/icons/icon-144x144.png" />
<p>
<!-- <img src="https://raw.githubusercontent.com/hsauers5/WhatsNextFlask/master/add.png" height=130px, width=600px /> -->

  <h3 class="modal-instructions" style="color: #ffffff; font-size: 18; font-family: Arial;font-style: oblique;"> 
    <img src="https://raw.githubusercontent.com/hsauers5/WhatsNextFlask/master/add.png" height=auto, width=auto />
  </h3>

      </div>
      <div class="modal-footer">
	  <button class="button-back" onclick="noThanks()"> No Thanks </button>
      </div>
	  </center>
    </div>
  </div>
</div>
</div>

</body>
</html>
